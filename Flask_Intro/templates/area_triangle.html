{% extends 'base.html' %}
{% block title %}Area of a Triangle{% endblock %}
{% block content %}
<div class="container mt-4">
  <div class="row align-items-center">
    <div class="col-md-6">
      <h1 class="minecraft">Compute Area of a Triangle</h1>

      <form method="POST" action="{{ url_for('area_triangle') }}" id="triangleForm" novalidate>
        <div id="formAlert" class="alert alert-danger d-none" role="alert"></div>

        <div class="mb-3">
          <label for="base" class="form-label minecraft">Base</label>
          <input type="number" id="base" name="base" class="form-control" step="any" min="0" required>
        </div>

        <div class="mb-3">
          <label for="height" class="form-label minecraft">Height</label>
          <input type="number" id="height" name="height" class="form-control" step="any" min="0" required>
        </div>

        <button type="submit" class="btn btn-primary minecraft">Calculate</button>
      </form>

      {% if area is not none %}
        <p class="minecraft mt-3">Area: {{ '%.2f'|format(area) }}</p>
      {% endif %}

      <a class="btn btn-sm btn-secondary minecraft mt-3" href="{{ url_for('home') }}">Back to Home</a>
    </div>

    <div class="col-md-6 text-center">
      <img src="{{ url_for('static', filename='images/trianglemov.gif') }}" 
           alt="Triangle Animation" 
           class="img-fluid rounded shadow-lg" 
           style="max-width: 90%;">
    </div>
  </div>
</div>

<script>
(function(){
  const form = document.getElementById('triangleForm');
  const baseInput = document.getElementById('base');
  const heightInput = document.getElementById('height');
  const alertEl = document.getElementById('formAlert');

  function showAlert(msg){
    alertEl.textContent = msg;
    alertEl.classList.remove('d-none');
    clearTimeout(alertEl._hideTimer);
    alertEl._hideTimer = setTimeout(()=> alertEl.classList.add('d-none'), 4000);
  }

  form.addEventListener('submit', function(e){
    const baseVal = (baseInput.value || '').trim();
    const heightVal = (heightInput.value || '').trim();

    if (!baseVal || !heightVal) {
      e.preventDefault();
      showAlert('Please enter both base and height before calculating.');
      if (!baseVal) baseInput.focus();
      else heightInput.focus();
      return;
    }
    const b = parseFloat(baseVal);
    const h = parseFloat(heightVal);
    if (!isFinite(b) || b < 0 || !isFinite(h) || h < 0) {
      e.preventDefault();
      showAlert('Please enter valid non-negative numbers for base and height.');
      if (!isFinite(b) || b < 0) baseInput.focus();
      else heightInput.focus();
      return;
    }
  });

  [baseInput, heightInput].forEach(inp => {
    inp.addEventListener('input', ()=> alertEl.classList.add('d-none'));
  });
})();
</script>
{% endblock %}
